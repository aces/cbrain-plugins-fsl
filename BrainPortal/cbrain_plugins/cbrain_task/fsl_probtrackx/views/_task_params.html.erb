
<%
# Use this template to create the content of the form
# for your task. You only need to provide the input
# tags for the INSIDE of the form, not the form itself,
# which is already generated by new.html.erb.
#
# This partial has access to the following variables:
#
#    form   -  The form block variable provided by form_for()
#              in new.html.erb; this variable can be used
#              with the CBRAIN params helper methods
#
#    @task  -  Your current task object
#
#    params -  A shortend to @task.params
#
# How to create input tags that will save directly into your
# params hash table and default to the current values found
# there:
#
#   1) Using the CBRAIN helper methods: (see CbrainTaskFormBuilder)
#
#     Call the methods on the 'form' variable; pass it a
#     symbol that will be the key to the params hash.
#
#   Examples:
#
#     form.params_text_field :filename
#
#     form.params_check_box  :confirm
#
#   2) Building the tags explicitely:
#
#     a) Use the .to_la method on Symbols or Strings to
#        generate the proper Rails variable name path.
#
#     b) Access params[] to get the current values.
#
#   Examples:
#
#     text_field_tag  :filename.to_la, params[:filename]
#
#     check_box_tag   :confirm.to_la, 1, params[:confirm]
#
-%>

<% input_collection = Userfile.find(params[:interface_userfile_ids]).first %>
<% file_list = input_collection.list_files.map(&:name).reject {|f| f=~ /\/logs\//} %>

<%= form.params_hidden_field :collection_id %>

<%= form.params_label  :mode, "Mode:" %>
<%= form.params_select :mode, [ "simple", "two_mask_symm", "seedmask" ] %>
<br>
<%= form.params_label :curve_thresh, "Curvature threshold:" %>
<%= form.params_text_field :curve_thresh, :size => 8 %>
<br>
<%= form.params_label :num_steps, "Number of steps per sample:" %>
<%= form.params_text_field :num_steps, :size => 8 %>
<br>
<%= form.params_label :step_length, "Step length (mm):" %>
<%= form.params_text_field :step_length, :size => 8 %>
<br>
<%= form.params_label :num_samples, "Number of samples:" %>
<%= form.params_text_field :num_samples, :size => 8 %>
<br>
<%= form.params_label  :seed_volume, "Seed volume:" %>
<%= form.params_select :seed_volume, file_list, :selected => file_list.find { |f| f =~ /seed/i } %>
<br>
<%= form.params_label  :stop_mask, "Stop mask:" %>
<%= form.params_select :stop_mask, file_list, :selected => file_list.find { |f| f =~ /stop/i } %>
<br>
<%= form.params_label  :transform, "Seed to DTI space transform matrix:" %>
<%= form.params_select :transform, file_list, :selected => file_list.find { |f| f =~ /.mat$/i } %>
<br>
<%= form.params_label :sample_basename, "Sample file basename:" %>
<%= form.params_text_field :sample_basename, :size => 80 %>
<br>
<%= form.params_label  :binary_mask, "Binary mask in diffusion space:" %>
<%= form.params_select :binary_mask, file_list, :selected => file_list.find { |f| f =~ /\/bedpostX\//i && f =~ /mask/i} %>
<br>
<%= form.params_label  :waypoints, "Waypoints:" %>
<%= form.params_select :waypoints, file_list, :selected => file_list.find { |f| f =~ /.list$/i } %>
<br>
<%= form.params_label :rseed, "Random seed:" %>
<%= form.params_text_field :rseed, :size => 3 %>


